name: build and publish
if: github.event_name == 'push' && startsWith(github.ref, 'refs/tags')

- name: Set up Python
  uses: actions/setup-python@v4
- name: Install python dependencies
  run: |
    python -m pip install --upgrade pip build
- name: Build Wheel and sdist
  run: |
    python -m build
- name: Publish package
  uses: pypa/gh-action-pypi-publish@release/v1
  with:
    password: ${{ secrets.TEST_PYPI_API_TOKEN }}
    repository_url: https://test.pypi.org/legacy/
